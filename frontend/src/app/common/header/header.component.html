<nav class="navbar navbar-expand-lg navbar-dark bg-dark py-2" *ngIf="authService.isLoggedIn()">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">
      <svg class="bi me-2" width="100" height="30" role="img" aria-label="Bootstrap">
        <image href="../assets/images/d3m.svg" width="100%" heigth="100%" alt="Docker Icon" />
      </svg>
    </a>
    <button class="navbar-toggler float-end" type="button" data-bs-toggle="collapse"
      data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
      aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item fs-6 ms-2" *ngFor="let item of navbar">
          <a class="nav-link text-white text-center" aria-current="page" [routerLink]="[item.link]"
            [ngClass]="{'text-white': !item.hover, 'text-warning' : item.hover, 'border-bottom': false }"
            (mouseover)="onHover(item)" (mouseleave)="removeHover(item)">
            <svg class="bi d-block mx-auto mb-1" width="24" height="24">
              <use [attr.xlink:href]="item.icon" />
            </svg>
            {{item.title}}
          </a>
        </li>
      </ul>
      <div class="d-flex justify-content-center">
        <div class="dropdown">
          <a href="#" class="nav-link text-white" d="dropdownMenu2" data-bs-toggle="dropdown" aria-expanded="false">
            <svg class="bi d-block mx-auto mb-1" width="24" height="24">
              <use xlink:href="bootstrap-icons.svg#person-circle" />
            </svg>
            Profilo
          </a>
          <ul class="dropdown-menu" aria-labelledby="dropdownMenu2">
            <li><button class="dropdown-item" type="button">Impostazioni</button></li>
            <li>
              <hr class="dropdown-divider">
            </li>
            <li><button class="dropdown-item" type="button" (click)="logout()">Esci</button></li>
          </ul>
        </div>
      </div>
      <div class="d-flex justify-content-center">
        <button type="button" class="btn btn-dark position-relative" data-bs-toggle="offcanvas"
          data-bs-target="#carelloOffCanvas">

          <span class="position-absolute top-0 start-50 translate-middle badge rounded-pill bg-danger">
            {{cartService.getItemsOnCartSessionStorage().length || 0}}
            <span class="visually-hidden">unread messages</span>
          </span>
          <svg class="bi d-block mx-auto mt-1" width="24" height="24">
            <use xlink:href="bootstrap-icons.svg#cart4" />
          </svg>
        </button>
      </div>
    </div>
  </div>
</nav>

<div class="offcanvas offcanvas-end" tabindex="-1" id="carelloOffCanvas" aria-labelledby="CarelloOFFCanvas">
  <div class="offcanvas-header">
    <h2 class="offcanvas-title" id="offcanvasExampleLabel">Carrello</h2>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <hr>
  <div class="offcanvas-body">
    <div class="order-md-last">
      <h4 class="d-flex justify-content-between align-items-center mb-3">
        <span class="text-primary">Articoli aggiunti</span>
        <span class="badge bg-primary rounded-pill">{{cartService.getItemsOnCartSessionStorage().length}}</span>
      </h4>
      <ul class="list-group mb-3" *ngIf="cartService.getItemsOnCartSessionStorage().length != 0">
        <li class="list-group-item d-flex justify-content-between lh-sm  px-3 py-3"
          *ngFor="let itemToCard of cartService.getItemsOnCartSessionStorage()">
          <div>
            <h6 class="mb-2">{{itemToCard.item.title}} <small class="fw-normal"> (€ {{itemToCard.item.price |
                number:'1.2-2'}})</small></h6>
            <div>
              <small class="d-inline remove text-danger" (click)="changeQuantity('x', itemToCard)">Rimuovi</small>
              <a class="btn btn-sm ms-2" (click)="changeQuantity('-', itemToCard)"><i
                  class="bi bi-dash-circle-fill text-primary me-3 plus-minus"></i></a>
              <p class="d-inline noselect">{{itemToCard.quantity}}</p>
              <a class="btn btn-sm" (click)="changeQuantity('+', itemToCard)"><i
                  class="bi bi-plus-circle-fill text-primary ms-3 plus-minus"></i></a>
            </div>
          </div>
          <span class="text-muted">€ {{itemToCard.item.price * itemToCard.quantity | number:'1.2-2'}}</span>
        </li>
        <li class="list-group-item d-flex justify-content-between">
          <span>Totale</span>
          <strong>€ {{cartService.getTotalAmount() | number: '1.2-2'}}</strong>
        </li>
        <li class="list-group-item">
          <div class="row mt-1">
            <div class="col">
              <label class="form-label mb-0 mt-1" for="numberInvoice">Numero Fattura:</label>
            </div>
            <div class="col-7">
              <input type="number" [(ngModel)]="numeroFattura" id="numberInvoice" class="form-control">
            </div>
          </div>
          <div class="row mt-1">
            <div class="col">
              <label class="form-label mb-0 mt-1" for="supplierSelect">Fornitore:</label>
            </div>
            <div class="col-7">
              <select class="form-select" [(ngModel)]="fornitore" aria-label="Default select example" id="supplierSelect">
                
                <ng-container *ngFor="let supplier of suppliers">
                  <option [value]="supplier.id">{{supplier.name}}</option>
                </ng-container>
              </select>
            </div>
          </div>
          <div class="row mt-1">
            <div class="col">
              <label class="form-label mb-0 mt-1" for="dateInvoice">Data Fattura:</label>
            </div>
            <div class="col-7">
              <input type="date" [(ngModel)]="dataFattura" id="dateInvoice" class="form-control">
            </div>
          </div>
          <div class="row mt-3">
            <div class="col">
              <label for="validationTextarea" class="form-label">Note:</label>
              <textarea [(ngModel)]="note" class="form-control" id="validationTextarea" placeholder="Inserisci note (facoltativo) ..."></textarea>
            </div>
          </div>
        </li>
      </ul>
      <div class="text-center" *ngIf="cartService.getItemsOnCartSessionStorage().length < 1">
        <div class="alert alert-warning" role="alert">
          Carrello vuoto
        </div>
      </div>

      <form class="card p-2" *ngIf="cartService.getItemsOnCartSessionStorage().length != 0">
        <div class="input-group">
          <button type="submit" class="btn btn-primary w-100" (click)="buy()">Acquista</button>
        </div>
      </form>
    </div>
  </div>
</div>